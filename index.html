
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html;charset=utf-8">
		<meta name="description" content="Involute spur gear generator and simulator" />
		<meta name="keywords" content="Gear generator, simulator, geargenerator, html, css, javascript, svg, download, free" />
		<meta name="author" content="Abel Vincze, Iparigrafika Ltd." />
		<meta property="og:url" content="http://geargenerator.com/" />
		<meta property="og:title" content="Involute spur gear generator and simulator" />
		<meta property="og:description" content="Gear Generator is a tool for creating involute spur gears and download them in SVG format. In addition it let you compose full gear layouts with connetcted gears to design multiple gears system with control of the input/output ratio and rotation speed. Gears can be animated with various speed to demonstrate working mechanism" />
		<meta property="og:image" content="http://geargenerator.com/shareimage.jpg" />
		<link rel="canonical" href="http://geargenerator.com/" />
		<title>Gear Generator</title>
		<script src="js/jquery-1.11.1.min.js"></script>
		<script type="text/javascript" src="js/jquery.cookie.js"></script>
		<script>
			/*
				GearGenerator version 1.01
				
			todo:
			(- tudo, * done, x cancelled)
			
			* remove any gear
			- remove any single gear
			* change parent gear
			* Diametral Pitch change recursive
			- Drag'n'drop move
			* add/remove gears
			* update scale for all gears
			* gear level RPM setting...
			
			* URL hash-ben mentes...
			
			x hide controls
			
			x show hide setting categories
			* share buttons
			* download buttons
			* about text
			
			* update gear text!!! (with ratio and RPM)
			
			-----
			fixed (version 1.01) on 2015 03 22:
			- shift enter RPM change then blur 
			- download issue when downloading wrong gear (typically after changing gear parameters)
			*/
			var shift,
				guides = true,
				geartext = true,
				grid = true,
				AM = 180/Math.PI,
				font = ["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-/=*;:,.<>", "0204284442324335464738181215080307480525452224683316263634174130100106373120004014232713", "4ABCDE/BD 4AFGDHIJKLM/NH/OL 4GFMPQLKJ 4AFGJKO/LM 4EAOR/ST 4AOR/ST 4HUEMPQLR 4ER/US/OA 2VA/ML/CO 4RGFMP 4ENR/AO/NS 4EAO 4ERWOA 4REOA 4UGFMPQLKJU 4SHIJKOA 4DVMPQLKJD 4ENHIJKOA/NS 4JKLQGFMP 4RO/CV 4RGFMPO 6XFO 6XEHVO 4RA/EO 4RTO/TV 4EARO 4YVMPSZaHYE 4OBabUGFVBA 4EMPSZI 4EDVMPSZaDR 4FMPSZbUcB 4MdCKJ/HS 4EMPSZbUefgh 4BabUE/AO 0Ai/QO 3Kj/bklgh 4EWI/AO/WB 1MPO 4Ai/SZTbUE/WT 4Ai/BabUE 4GFMPSZbUG 4mi/SZbUGFA 4nI/EMPSZbU 4Ai/BabU 4IZSocGFA 4GFpC/Ii 4IE/DVMPi 4IVi 4IFaMi 4IA/Ei 4Igm/Vi 4EAIi 3YVMPQLCjY 2QLM/VA 4EABNHIJKLQ 4QLKJIHDGFMP/TH 4DBKF 4ROibUGFMP 4SHDGFMPiCK 4ORV 4NBPMFGDHNiQLKJIH 4UNiQLKJDVM 4pq/US 4US 4RA 4Ii/DB 4US/pq/JP/GQ 1ZN/oMh 1ZN/or 1rMh 0PA 3KSF 3OHA"],
				baserot = 0,
				rot = baserot,				// global base rotation
				RPM = 0,
				realRPM = 0,
				rota = 0,
				animation = false,
				loop = false,
				gears = [],
				selectedgear = -1,
				defaultgear = {	ID: -1,	N: 9, D: 1.5, P: 6, PA: 20, rot: rot, gearangle: 0, jointangle: -60	},
				has3d,
				theme = 1;

			function fixInput( v, setFN, def, min, max ) {
				if( isNaN( v ) ) v = def;
				if( min != undefined && v<min ) v=min;
				else if( max != undefined && v>max ) v=max;
				setFN( v );
				return v;
			}
			function getNfix() { return fixInput( Number( $("#N").val() ), setN, gears[selectedgear].N, 4, 200 ); }			
			function getN() { return Number( $("#N").val() ); }			
			function setN( v ) { $("#N").val( v ); }			
			function getDfix() { return fixInput( Number( $("#D").val() ), setD, gears[selectedgear].D, 0.1 ); }			
			function getD() { return Number( $("#D").val() ); }			
			function setD( v ) { $("#D").val( v ); }			
			function getPfix() { return fixInput( Number( $("#P").val() ), setP, gears[selectedgear].P, 1, 200 ); }
			function getP() { return Number( $("#P").val() ); }
			function setP( v ) { $("#P").val( v ); }			
			function getPAfix() { return fixInput( Number( $("#PA").val() ), setPA, gears[selectedgear].PA, 12, 35 ); }			
			function getPA() { return Number( $("#PA").val() ); }			
			function setPA( v ) { $("#PA").val( v ); }			
			function getRPMfix() { return fixInput( Number( $("#RPM").val() ), setRPM, RPM, -360, 360 ); }			
			function getRPM() { return Number( $("#RPM").val() ); }			
			function setRPM( v ) { $("#RPM").val( v ); }			
			function getscalefix() { return fixInput( Number( $("#scale").val() ), setscale, 100, 25, 400 ); }			
			function getscale() { return Number( $("#scale").val() ); }			
			function setscale( v ) { $("#scale").val( v ); }			
			function getPGfix() { return fixInput( Number( $("#PG").val() ), setPG, gears[selectedgear].parentID, -1 ); }			
			function getPG() { return Number( $("#PG").val() ); }			
			function setPG( v ) { $("#PG").val( v ); }			
			function getCAXLE() { return !!$("#CAXLE:checked").val(); }			
			function setCAXLE( v ) { $("#CAXLE").prop("checked", v==true ); }			
			function getgrid() { return !!$("#grid:checked").val(); }			
			function setgrid( v ) { $("#grid").prop("checked", v==true ); }			
			function getguides() { return !!$("#guides:checked").val(); }			
			function setguides( v ) { $("#guides").prop("checked", v==true ); }			
			function getlabels() { return !!$("#labels:checked").val(); }			
			function setlabels( v ) { $("#labels").prop("checked", v==true ); }			
			function getCAfix() { return fixInput( Number( $("#CA").val() ), setCA, gears[selectedgear].jointangle ); }			
			function getCA() { return Number( $("#CA").val() ); }			
			function setCA( v ) { $("#CA").val( v ); }			
			
			// --------------------------------------------------------------------------------------------------
			
			function Nadd( a ) {
				setN( getN()+a );
				Nchange();
			}
			function PAadd( a ) {
				setPA( getPA()+a );
				PAchange();
			}
			function Aadd( a ) {
				setCA( getCA()+a );
				CAchange();
			}
			function scalem( m ) {
				setscale( getscale()*m );
				scaleChange();
			}
			
			function Nchange() {
				if( shift ) {
					setP( getNfix()/getD() );
					updatePitches();
				} else {
					setD( getNfix()/getP() );
					updateGears();
				}
			}
			function Dchange() {
				if( shift ) {
					setP( getN()/getDfix() );
					updatePitches();
				} else {
					setN( Math.floor( getDfix()*getP() ) );
					Nchange();
				}
			}
			function Pchange() {
				setD( getN()/getPfix() );
				updatePitches();
			}
			function PAchange() {
				getPAfix();
				updatePitches();
			}
				function calcP() {
					setP( getN()/getD() );
				}
				
			function RPMchange() {
				RPM = getRPMfix();
				if( shift ) {
					RPM = RPM/gears[selectedgear].totalratio;
					setRPM( RPM );
				}
				updateListItemText( 0 );
				updateHash();
			}
			function scaleChange() {
				getscalefix();
				renderAllGears();
				updateHash();
			}
			function CAchange() {
				gears[selectedgear].jointangle = getCAfix();
				positionGears( selectedgear );
				rotateGears( selectedgear );
				updateHash();
				maxSize();
			}
			function PGchange() {
				var ID = selectedgear,
					gear = gears[ID]
					pID = gear.parentID,
					PG = getPGfix();
				if( PG>=0 && !isChildOf( PG, ID ) && PG != pID && PG<gears.length) {
					var parentChilds = gears[pID].childIDs;
					parentChilds.splice( parentChilds.lastIndexOf( ID ), 1);
					gear.parentID = PG;
					gears[gear.parentID].childIDs.push( ID );
					updateJoint();
				} else setPG( pID );
			}

			function CAXLEchange() {
				var ID = selectedgear,
					gear = gears[ID];
				
				if( gear.parentID<0 ) {
					setCAXLE( true );
					return;
				}
				updateJoint();
			}
			function updateJoint() {
				var ID = selectedgear,
					gear = gears[ID],
					pP = gears[gear.parentID].P,
					pPA = gears[gear.parentID].PA;
				if( !(gear.axlejoint = getCAXLE()) && ( pP != getP() || pPA != getPA() ) ) {
					setD(getN()/pP);
					setP(pP);
					setPA(pPA);
					updatePitches();
				} else {
					positionGears( ID );
					rotateGears( ID );
					updateListItemText( ID );
					updateHash();
				}
			}
			
			function displaychange() {
				if( grid != (grid = getgrid()) ) makeGrid();
				guides = getguides();
				setGuidesClass();
				geartext = getlabels();
				setLabelsClass()

				writeCookies();
			}
			function setGuidesClass() {
				if( getguides() ) $("#screen").removeClass("noguides");
				else $("#screen").addClass("noguides");
			}
			function setLabelsClass() {
				if( getlabels() ) $("#screen").removeClass("nolabels");
				else $("#screen").addClass("nolabels");
			}
			// --------------------------------------------------------------------------------------------------

			function createGear( N, D, P, PA, ID ) {
				var sc = getscale(),
					A = 1/P,
					B = 1.157/P,
					OD = (N + 2)/P,
					RD = (N - 2.3)/P,
					BC = D*Math.cos(PA*(Math.PI/180)),
					CP = Math.PI/P,
					rmin = RD/2,
					rmax = OD/2,
					rbase = BC/2,
					pts = [],
					ac = 0,
					aca = 0,
					w = Math.ceil( OD/2*sc )*2,
					h = w,
					
					addpts = function( p ) { pts.push( p );	},
					pt = function( r, a ) { return { r: r, a: a }; },
			
					out = '<?xml version="1.0" encoding="utf-8"?><!-- Generator: Iparigrafika Gear Generator by Abel Vincze http://geargenerator.com/ --><svg version="1.2" class="svggear" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="'+w+'px" height="'+h+'px" viewBox="'+(-w/2)+' '+(-h/2)+' '+w+' '+h+'" overflow="scroll" xml:space="preserve">';
				
				// calc
				addpts( pt( rmin, 0 ) );			//first point
				
				for( var i=1, pn=0, step=1, first = true; i<100; i+=step ) {
					// get a point...
					var bpl = polarToLinear( pt( rbase, -i ) ),			//base point linear
						len = ((rbase*Math.PI*2)/360)*i,				//length
						opl = polarToLinear( pt( len, -i+90 ) ),		//add line
						np = linearToPolar( { x: bpl.x+opl.x, y: bpl.y+opl.y } );
						
					if( np.r>= rmin ) {
						//console.log( np.a );
						if( first ) {
							first = false;
							step=(2/N)*10;
							//console.log("first point at "+i );
						}
						if( np.r<D/2 ) {
							ac = np.a;
							aca = i;
						}
						pn++;
						if( np.r> rmax ) {
							np.r = rmax;
							addpts( np );
							break;	
						}
						addpts( np );
					}
				} 
				// tukrozes
				var fa = 360/N,						// final a
					ma = fa/2 + 2*ac,				// mirror a
					fpa = (fa-ma)>0?0:-(fa-ma)/2,	// first point a
					m=pts.length;
				pts[0] = pt( rmin, fpa );			// fix first point a
				while( pts[m-1].a>ma/2 ) {
					pts.splice(m-1,1);
					m--;
					pn--;	
				}

				for( var i=pn; i>=0; i-- ) {
					var bp = pts[i],
						na = ma-bp.a;					
					addpts( pt( bp.r, na ) );
				}
				// repeat
				for( var i=1,m=pts.length; i<N; i++ ) {
					for( var p=0; p<m; p++ ) {
						var bp = pts[p],
							na = bp.a+fa*i;
						addpts( pt( bp.r, na ) );
					}
				}
				// print points
				out += '<polygon id="gearpoly'+ID+'" data-id="'+ID+'" class="gear" fill="#ddd" stroke="#444" stroke-width="1" stroke-miterlimit="10" points="';
				for( var i=0; i<pts.length; i++ ) {
					var point = polarToLinear( pts[i] );
					out += fix6(point.x*sc)+','+fix6(point.y*sc)+' ';
				}
				out += '"/>';
				
				// center cross
				out += '<g class="guides"><polyline fill="none" stroke="#444" stroke-width="0.5" stroke-miterlimit="10" points="';
				out += '10,0 -10,0"/>';
				out += '<polyline fill="none" stroke="#444" stroke-width="0.5" stroke-miterlimit="10" points="';
				out += '0,10 0,-10"/></g>';
				// first tooth marker
				var zpr = 1.57/P*sc/4;
					zp = polarToLinear( pt( D/2, ma/2 ) );
				out += '<circle fill="#c00" class="firstmarker" stroke="none" stroke-miterlimit="10" cx="'+fix6(zp.x*sc)+'" cy="'+fix6(zp.y*sc)+'" r="'+fix6(zpr)+'"/>';
				
				// text on wheel
				var tdata = makeText("*"+ID+" N="+N+" Pitch D="+fix2(D)+" P="+fix2(P)+" PA="+fix2(PA), 2),
					textH = (RD/2)/7/6,	// betu magassaga (/6 a pixelmagassag miatt)
					textH = textH>0.03?0.03:textH,
					textB = (RD/2)-textH*10,	// alapvonal 75%-nal
					plotAngle = 180/((textB*Math.PI)/textH);
					
					
				out += '<g class="geartext">'+renderSVGPrecisionPolarText( tdata, textB, textH, plotAngle, sc )+'</g>';
				// guides
				out += '<g class="guides gearguides" opacity="0.2">';	
				out += '<circle class="pitch" fill="none" stroke="#f00" stroke-miterlimit="10" cx="0" cy="0" r="'+fix2((D/2)*sc)+'"/>'; // pitch circle
				//out += '<circle class="root" fill="none" stroke="#ccc" stroke-miterlimit="10" cx="0" cy="0" r="'+fix2((RD/2)*sc)+'"/>'; // Root circle
				out += '<circle class="outer" fill="none" stroke="#ccc" stroke-miterlimit="10" stroke-dasharray="2,2" cx="0" cy="0" r="'+fix2((OD/2)*sc)+'"/>'; // Outer circle
				out += '<circle class="base" fill="none" stroke="#00f" stroke-miterlimit="10" stroke-dasharray="2,2" cx="0" cy="0" r="'+fix2((BC/2)*sc)+'"/>'; // Base circle
				out += '</g>';

				out += '</svg>';
				
				
				return { svg: out, gearangle: fa, baseangle: ac, Rsc: D*sc/2, w: w, h: h };
			}
			function linearToPolar( c ) {
				var x = c.x, y = c.y, r, a;
				//var AM = 180/Math.PI;
				r = Math.sqrt( x*x + y*y );
				a = Math.asin( y/r )*AM;
				if( x<0 ) a = 180-a;
				a = (a+360)%360;
				return { r: r, a: a }
			}
			function polarToLinear( p ) {
				var r = p.r, a = p.a, x, y;
				//var AM = 180/Math.PI;
				a = ((a+360)%360)/AM;
				
				x = Math.cos( a )*r;
				y = -Math.sin( a )*r;
				
				return { x: x, y: y }
			}

			function fix2( v ) {
				return Math.round( 100*v )/100;
			}
			function fix6( v ) {
				return Math.round( 10000*v )/10000;
			}

			function createSVGgrid( sc ) {
				/*var cl = $("body").attr("class"),
					col;
				
				if(cl=="col0") col = "#888";
				if(cl=="col1") col = "#fff";
				if(cl=="col2") col = "#888";*/
			
			
				var col = ["#888","#fff","#888"][theme],
					subd = 10,
					weight = 1,
					scdot = sc+0.5;
					out = '<svg version="1.2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="'+sc+'px" height="'+sc+'px" viewBox="0 0 '+sc+' '+sc+'" xml:space="preserve">';	//+out+'</svg>';
				
				out += '<g class="grid" stroke="'+col+'" opacity="0.2">'
				out += '<polyline fill="none" stroke-width="'+weight+'" stroke-linecap="square" stroke-miterlimit="2"  points="';
				out += '0.5 '+scdot+' 0.5 0.5 '+scdot+' 0.5"></polyline>';
				
				for( var i=1; i<10; i++ ) {
					var pos = (sc/10)*i+0.5;
					out += '<polyline fill="none" stroke-width="'+(weight/2)+'" stroke-linecap="square" stroke-miterlimit="2"  points="0.5 '+pos+' '+scdot+' '+pos+'"></polyline>';
					out += '<polyline fill="none" stroke-width="'+(weight/2)+'" stroke-linecap="square" stroke-miterlimit="2"  points="'+pos+' 0.5 '+pos+' '+scdot+'"></polyline>';
					
				}
				
				out += '</g></svg>';
				return out;
			}
			function makeGrid() {
				if( grid ) {
					var svg = createSVGgrid( getscale() ),
						b64 = 'data:image/svg+xml;base64,' + window.btoa(svg),
						url = 'url("' + b64 + '")';				
				} else {
					var url = "none";
				}
				$('#screen').css('backgroundImage', url);

			}
			// -------------- FONT
			function getchardata( chr ) {
				var i=font[0].lastIndexOf( chr ),
					data=[];
				if( i>-1 ) {
					var chdata = font[2].split(" ")[i],
						l = 0;
					data[0] = Number(chdata.substr(0,1));
					for( var p=0,pi; p<chdata.length; p++ ) {
						pi = getindex( chdata.charCodeAt(p) );
						if( pi<0 ) data[++l] = [];
						else data[l].push( font[1].substr( pi ,2 ) );
					}
				} else data[0]=chr==" "?3:-1;
				return data;
			}
			function getindex( code ) {
				code-=65;
				code>25&&(code-=6);
				return code*2;
			}
			
			function makeText( txt, chs ) {
				var width,
					pos = 0,
					data = [0];
				chs = chs==undefined?1: chs;
				for( var i=0, cdata; i<txt.length; i++ ) {
					cdata = getchardata( txt.substr( i, 1 ) );
					if( cdata[0]>=0 ) {
						for(var l=1; l<cdata.length; l++ ) {
							for( var p=0, pt, line=[]; p<cdata[l].length; p++ ) {
								pt = cdata[l][p].split("");
								line.push( { x: Number(pt[0])+pos, y: Number(pt[1]) } );
							}
							data.push( line );
						}
						pos += chs+cdata[0];						
					}
				}
				if( pos>0 ) data[0] = pos-1;
				return data;
			}
			function renderSVGLinearText( tdata, textB, pixH, weight ) {
				var out = '<g class="text">',
					add = weight/2;
				if( add<0.5 ) add = 0.5;
					
				for( var i=1; i<tdata.length; i++ ) {				
					out += '<polyline fill="none" stroke="#444" stroke-width="'+weight+'" stroke-linecap="square" stroke-miterlimit="2"  points="';
					for( var p=0; p<tdata[i].length; p++ ) {
						out += (tdata[i][p].x*pixH+add) + " " + (textB-tdata[i][p].y*pixH+add) + " ";
					}
					out += '"/>';
				}				
				out += "</g>";
				return out;
			}
			function renderSVGPolarText( tdata, textB, pixH, plotAngle, sc ) {
				
				var angularLength = tdata[0]*plotAngle,		// angular length of the text
					ba = angularLength/2,					// base angle
					out = '<g class="text">';
					
				for( var i=1; i<tdata.length; i++ ) {
					out += '<polyline fill="none" stroke="#444" stroke-width="0.5" stroke-linecap="square" stroke-miterlimit="1"  points="';
					for( var p=0, a, r, dot; p<tdata[i].length; p++ ) {
						a = -tdata[i][p].x * plotAngle + ba;
						r = (tdata[i][p].y-5) * pixH + textB;
						dot = polarToLinear( { r: r, a: a } );
						out += dot.x*sc + " " + dot.y*sc + " ";
					}
					out += '"/>';
				}				
				out += "</g>";
				return out;
			}
			function renderSVGPrecisionPolarText( tdata, textB, pixH, plotAngle, sc ) {
				
				var angularLength = tdata[0]*plotAngle,		// angular length of the text
					ba = angularLength/2,					// base angle
					out = '<g class="text">';
					
				for( var i=1; i<tdata.length; i++ ) {
					out += '<polyline fill="none" stroke="#444" stroke-width="0.5" stroke-linecap="square" stroke-miterlimit="1"  points="';
					for( var p=0, a, r, dot, dx, inc, lx, ly, x, y, mp=tdata[i].length; p<mp; p++ ) {
					
						x = tdata[i][p].x;
						y = tdata[i][p].y;
						if( p==0 ) { 
							lx = x;
							ly = y
							a = -lx * plotAngle + ba;
							r = (ly-5) * pixH + textB;
							dot = polarToLinear( { r: r, a: a } );
							out += fix2(dot.x*sc) + " " +fix2(dot.y*sc) + " ";
						} else {
							dx = Math.abs( x-lx );
							if( dx==0 ) {
								dx=1;
							}
							ix = ( x-lx )/dx;
							iy = ( y-ly )/dx;
							for( var s=1, X, Y; s<=dx; s++ ) {
								Y = ly + iy*s;
								X = lx + ix*s;
								a = -X * plotAngle + ba;
								r = (Y-5) * pixH + textB;
								dot = polarToLinear( { r: r, a: a } );
								out += fix2(dot.x*sc) + " " + fix2(dot.y*sc) + " ";
							}
							lx = x;
							ly = y;
						}
					}
					out += '"/>';
				}				
				out += "</g>";
				return out;
			}
			
			function replaceWithSVGText( selection, upperCase, pixH, weight, chs  ) {
				pixH = pixH || 1;
				chs = chs==undefined? 2: chs;
				weight = weight || 1;
				
				var txt = selection.html();
				
				if( upperCase ) txt = txt.toUpperCase();
					
				var tdata = makeText( txt, chs ),
					w = tdata[0]*pixH+weight,
					h = pixH*8+weight,
					out = renderSVGLinearText( tdata, pixH*8, pixH, weight );
				
				out = '<svg version="1.2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="'+w+'px" height="'+h+'px" viewBox="0 0 '+w+' '+h+'" xml:space="preserve">'+out+'</svg>';
				
				selection.html( out );
			}
			// --------------------------------------------------------------------------------------------------

			function addNewGear() {
				if( selectedgear<0 ) return;
				var gear = gears[selectedgear],
					P = gear.P,
					N = 13,
					D = N/P,
					PA = gear.PA;
					
				addGear( gear, false, N, D, P, PA );
			}
			function addGear( parentgear, axlejoint, N, D, P, PA, A ) {
				parentgear = parentgear || defaultgear;
				axlejoint = axlejoint || false;
				N = N || parentgear.N;
				D = D || parentgear.D;
				P = P || parentgear.P;
				PA = PA || parentgear.PA;
				A = A==undefined? parentgear.jointangle: A;
				
				var ID = addGearData( parentgear.ID, axlejoint, N, D, P, PA, A ).ID;
				addGearDataProcess( ID );
				updateGearDOM( ID );
				positionGears( ID );
				rotateGears( ID );
				selectGear( ID );
				updateHash();
				setListItemText( ID );
				maxSize();
				return gears[ID];
			}
			function addGearData( parentgearID, axlejoint, N, D, P, PA, A ) {
				var ID = gears.length,
					thegear = createGear( N, D, P, PA, ID ),
					newgear = {
						ID:			ID,
						parentID:	parentgearID,
						axlejoint:	axlejoint,
	
						N:			N,
						D:			D,
						P: 			P,
						PA:			PA,
						// ez az uj fogaskerekbol adodik
						rot:		0,		// ezt nem igy persze
						gearangle:	thegear.gearangle,				
						
						ratio:		1,
						totalratio: 1,
						
						jointangle:	A,			// default, hogy alatta...
						baseangle:	thegear.baseangle,
					//	geardata:	createGear( N,D,P ),
					
						Rsc:		thegear.Rsc,
						
						svg:		thegear.svg,
						svgwidth:	thegear.w,		// fogaskerek svg merete.
						svgheight:	thegear.h,
						svgoffsetx:	-thegear.w/2,		// svg offset a kozeppont pozicionalasahoz
						svgoffsety:	-thegear.h/2,
						offsetx:	0,
						offsety:	0,
						x:			0,			// aktualis pozicio, ezt ki kell szamolni a csatlakozas szogebol, tavolsagabol.
						y:			0,
						
						childIDs:	[]
					};
				gears[ID] = newgear;
				return gears[ID];
			}
			function addGearDataProcess( ID ) {
				var newgear = gears[ID],
					parentID = newgear.parentID,
					parentgear = (newgear.parentID<0)? defaultgear: gears[newgear.parentID];
							
				if( parentgear.ID >= 0 ) {
					gears[parentgear.ID].childIDs.push( ID );
				}

				// add gear to DOM
				$("#screen").append( '<div id="gearcontainer'+ID+'" class="svg">'+newgear.svg+'</div>' );
				$("#gearselector").append( '<li id="gearlistitem'+ID+'" data-id="'+ID+'" class="listitem"></li>' );
				$("#gearlistitem"+ID).bind( "click", selectionClick );
				setGearEvents( ID );
				setListItemText( ID );
				return gears[ID];
				
			}
			function selectionClick() {
				var ID = Number($(this).attr("data-id"));
				if( ID == undefined ) return false;
				selectGear( ID );
				updateHash();
			}

			function removeGear() {

				//console.log(" childs: "+getTotalChildNumber( ID ));
				
				var ID = selectedgear,
					newgears = [],
					oldIDs = [],
					chg = getTotalChildNumber( ID );
					
				if( chg>0 ) {
				    if (!confirm("This gear have "+chg+" child gear"+(chg>1?"s":"")+".\nChild gears will be also removed!")) return;
				}
				
				selectedgear = removeAllGears( ID );
				if( selectedgear<0 ) selectedgear = 0;
				
				//console.log( gears );
				
				// delete gear
				for( var i=0, newID=0; i<gears.length; i++ ) {
					if( gears[i] ) {
						
						newgears[newID] = gears[i];
						oldIDs[newID++] = i;
						
						
					}
				}
				
				gears = newgears;
				for( var i=0; i<gears.length; i++ ) {
					changeID( oldIDs[i], i );
					$("#gearlistitem"+oldIDs[i]).attr("id","gearlistitem"+i).attr("data-id", i );
					$("#gearcontainer"+oldIDs[i]).attr("id","gearcontainer"+i);
					$("#gearpoly"+oldIDs[i]).attr("id","gearpoly"+i).attr("data-id", i );
					if( selectedgear == oldIDs[i] ) selectedgear = i;
				}
				
				selectGear( selectedgear );
				renderAllGears();
				updateHash();
				updateListItemText(0);
				maxSize();
			}
			function removeAllGears( ID ) {

				var	gear = gears[ID],
					pi = gear.parentID,
					chs = gear.childIDs.slice();
				
				for( var i=0; i<chs.length; i++ ) {
					removeAllGears( chs[i] );
				}
				// remove this ID from parent's child
				if( pi>=0 ) {
					var parentChilds = gears[pi].childIDs;
					parentChilds.splice( parentChilds.lastIndexOf( ID ), 1);
				}
				// delete gear
				if( ID>0 ) {
					gears[ID] = null;	//.splice( ID, 1 );
					$("#gearlistitem"+ID).remove();
					$("#gearcontainer"+ID).remove();
				}
				return pi;
			}
				function getTotalChildNumber( ID ) {
					var childs = 0,
						gear = gears[ID];
					
					for( var i=0; i<gear.childIDs.length; i++ ) {
						childs += 1+getTotalChildNumber( gear.childIDs[i] );
					}
					return childs;
				}
				function isChildOf( chID, ID ) {
					var isChild = false,
						checkChilds = function( ID ) {
							var gear = gears[ID];
							if( gear.ID==chID ) isChild=true;
							for( var i=0; i<gear.childIDs.length; i++ ) {
								//if( gear.childIDs[i]==chID ) isChild=true;
								checkChilds( gear.childIDs[i] );
							}
							
						};
					checkChilds( ID );
					return isChild;
				}
				function changeID( oldID, newID ) {
					
					for( var i=0; i<gears.length; i++ ) {
						if( gears[i].parentID==oldID ) gears[i].parentID = newID;
						if( gears[i].ID==oldID ) gears[i].ID = newID;
						for( var c=0; c<gears[i].childIDs.length; c++ ) {
							if( gears[i].childIDs[c]==oldID ) {
								gears[i].childIDs[c] = newID;
							}
						}
					}
					
				}
			
			function rotateGears( ID ) {
				//console.log("rotate gears "+ID);
				// rotate childs (recursive)
				ID = ID || 0;
				var gear = gears[ID];
				if( ID == 0 ) { gears[ID].rot = rot-gears[ID].jointangle; }
				else {
					var parentgear = gears[ gear.parentID ],
						newrot;
					
					if( gear.axlejoint ) {
						gears[ID].rot = parentgear.rot-gears[ID].jointangle;	// + gear.jointangle
						
					} else {
						gears[ID].rot= 180-((parentgear.rot+gear.jointangle)*gear.ratio)-gear.jointangle;//-((gear.jointangle*2)*gear.ratio);
						
					}
					//console.log("rotation "+gears[ID].rot);
				}
				setGearDOMRotation( ID );
				
				for( var i=0; i<gear.childIDs.length; i++ ) {
					rotateGears( gear.childIDs[i] );
				}
				
			}
			function selectParent() {
				var ID = gears[selectedgear].parentID;
				if( ID>=0 ) selectGear( ID );
			}
			function selectGear( ID ) {
				selectedgear = ID;	// select this geat + set Selection!!!
				selectListItem( ID );
				setEditorValues( ID );
				setDownloadData( ID );
				$(".svg").removeClass("selected");
				$("#gearcontainer"+ID).addClass("selected");

			}
			function setDownloadData( ID ) {
				var gear = gears[ID],
					filename = "gg_gear N"+gear.N+" D"+fix2(gear.D)+" P"+fix2(gear.P)+" PA"+fix2(gear.PA)+" @"+fix2(getscale())+".svg";
				$("#svgdata").val( gear.svg );
				$("#svgfilename").val( filename );
			}
			function setEditorValues( ID ) {
				var data = gears[ID];
				
				setN( data.N );
				setD( data.D );
				setP( data.P );
				setPA( data.PA );
				setPG( data.parentID );
				setCA( data.jointangle );
				setCAXLE( data.axlejoint );
				
				//$("#out").html( '<?xml version="1.0" encoding="utf-8"?><!-- Generator: Iparigrafika SpurGearAnalyzator v2 by Abel Vincze http://iparigrafika.hu/gear -->'+data.svg );
			}
			function positionGears( ID ) {
				//console.log("rotate gears");
				// rotate childs (recursive)
				ID = ID || 0;
				var gear = gears[ID],
					parentID = gear.parentID,
					parentgear;
				
				//console.log( parentID );
				
				if( parentID>=0 ) {
					parentgear = gears[ parentID ];
				
					gear.ratio = parentgear.N/gears[ID].N;
					
					// pozicio megadasa a parent alapjan
					if( gear.axlejoint ) {
						gear.offsetx = 0;
						gear.offsety = 0;
						
						gear.totalratio = parentgear.totalratio;
					} else {
						var dist = parentgear.Rsc+gear.Rsc;
						
						gear.offsetx = Math.cos( gear.jointangle/AM )*dist;
						gear.offsety = -Math.sin( gear.jointangle/AM )*dist;
						
						gear.totalratio = parentgear.totalratio*gear.ratio;
					}
					gear.x = parentgear.x + gear.offsetx;
					gear.y = parentgear.y + gear.offsety;
					
					//console.log( gears[ID].x );
			
				} else {
					var temp = gear.svgwidth/2,
						sc = getscale(),
						m = Math.ceil( (temp+(sc/5))/sc );
					gear.x = m*sc;
					gear.y = m*sc;

				}
				//setListItemText( ID );
				updateGearDOM( ID );

				for( var i=0; i<gear.childIDs.length; i++ ) {
					positionGears( gear.childIDs[i] );
				}
				
			}
			function renderAllGears() {
				renderGear(0);
				positionGears(0);
				rotateGears(0);
				makeGrid();
				maxSize();
			}
			function renderGear( ID ) {
				var gear = gears[ID];
				//console.log( "gear"+ID+" CA: "+gear.jointangle );
				updateGear( ID, gear.N, gear.D, gear.P, gear.PA, gear.jointangle );
				
				for( var i=0; i<gear.childIDs.length; i++ ) {
					renderGear( gear.childIDs[i] );
				}
			}
			function updatePitches() {
				var ID = selectedgear,
					P = getP(),
					PA = getPA(),
					N = getN();
				
				if( gears[ID].P != P || gears[ID].PA != PA ) {
					updatePitch( N, P, PA, ID );
					if( !gears[ID].axlejoint ) {
						updateParentPitch( P, PA, ID );
					}
					
					positionGears( 0 );
					rotateGears( 0 );
					updateHash();
					maxSize();
					//updateListItemText( ID );
					setDownloadData( ID );
				}
			}
			function updatePitch( N, P, PA, ID, excludedChild ) {
				excludedChild = excludedChild || -1;
				
				var gear = gears[ID],
					D = N/P;
			
				updateGear( ID, N, D, P, PA, gear.jointangle );
				
				for( var i=0; i<gear.childIDs.length; i++ ) {
					var chID = gear.childIDs[i];
					if( chID != excludedChild && !gears[chID].axlejoint ) {
						updatePitch( gears[chID].N, P, PA, chID );
					}
				}
					
			}
			function updateParentPitch( P, PA, ID ) {
				if( gears[ID].axlejoint ) return;
				var parentID = gears[ID].parentID;
				if( parentID>=0 ) {
					updatePitch( gears[parentID].N, P, PA, parentID, ID );	
					updateParentPitch( P, PA, parentID );
				}

			}
			function updateGears() {
				var ID = selectedgear;
				updateGear( ID );
				positionGears( ID );
				rotateGears( ID );
				updateListItemText( ID );
				updateHash();
				maxSize();
				setDownloadData( ID );
			}
			function updateGear( ID, N, D, P, PA, CA ) {
				N = N || getN();
				D = D || getD();
				P = P || getP();
				PA = PA || getPA();
				CA = CA==undefined? getCA(): CA;
				var thegear = createGear( N, D, P, PA, ID );
					
				gears[ID].N = N;
				gears[ID].D = D;
				gears[ID].P = P;
				gears[ID].PA = PA;
				gears[ID].jointangle = CA;
				gears[ID].gearangle = thegear.gearangle;
				gears[ID].baseangle = thegear.baseangle;

				gears[ID].svg = thegear.svg;
				gears[ID].svgwidth = thegear.w;		// fogaskerek svg merete.
				gears[ID].svgheight = thegear.h;
				gears[ID].svgoffsetx = -thegear.w/2;		// svg offset a kozeppont pozicionalasahoz
				gears[ID].svgoffsety = -thegear.h/2;
				gears[ID].Rsc = thegear.Rsc;
			
				$("#gearcontainer"+ID).html( thegear.svg );
				setGearEvents( ID );
			}
			function setGearEvents( ID ) {
				$("#gearpoly"+ID).bind( "click", selectionClick );
			}
			function updateGearDOM( ID ) {
				var gearc = $("#gearcontainer"+ID),
					data = gears[ ID ];
				
				gearc.css( { width:			data.svgwidth,
							height:			data.svgheight } );
				setGearDOMRotation( ID );
			}
			function setGearDOMRotation( ID ) {
				var	gear = $("#gearcontainer"+ID),
					data = gears[ ID ];
				gear.css( { "transform": 	"translate3d("+fix2(data.x+data.svgoffsetx)+"px,"+fix2(data.y+data.svgoffsety)+"px,0) rotate("+fix6(data.rot+data.baseangle)+"deg)"  } );
				//console.log( (data.x+data.svgoffsetx)+"+"+(data.y+data.svgoffsety) )
			}
			function selectListItem( ID ) {
				$(".listitem").removeClass("selected");
				$("#gearlistitem"+ID).addClass("selected");
			}
			function setListItemText( ID ) {
				$("#gearlistitem"+ID).html( '#'+(ID)+' - ratio: '+getRatio( 1/gears[ID].totalratio )+' - RPM: '+fix2(gears[ID].totalratio*RPM) );
				
			}
			function updateListItemText( ID ) {
				var gear = gears[ID];
				
				setListItemText( ID );
				//updateGearsDOM( ID );

				for( var i=0; i<gear.childIDs.length; i++ ) {
					updateListItemText( gear.childIDs[i] );
				}
				
			}
				function getRatio( r ) {
					var out;
					r = Number(r);
					if( r<1 ) {
						out = "1:"+fix2(1/r);
					} else {
						out = fix2(r)+":1";
					}
					return out;
				}
	
			//var maxw = 0, maxh = 0;
			function maxSize() {
				var mx = 0, my = 0;
				
				for( var i=0, gear, gmx, gmy, add; i<gears.length; i++ ) {
					gear = gears[i];
					add = (gear.svgwidth/2)*1.5;
					gmx = gear.x+add;
					gmy = gear.y+add;
					if( gmx>mx ) mx = gmx;
					if( gmy>my ) my = gmy;
				}
				
				$("#screen").css( { width: mx, height: my } );
				
			}
	
			// --------------------------------------------------------------------------------------------------

			function reset() {
				$("#N").bind("enterKey",Nchange);
				$("#D").bind("enterKey",Dchange);
				$("#P").bind("enterKey",Pchange);
				$("#PA").bind("enterKey",PAchange);
				$("#scale").bind("enterKey",scaleChange);
				$("#RPM").bind("enterKey",RPMchange);
				$("#CA").bind("enterKey",CAchange);
				$("#PG").bind("enterKey",PGchange);
				$("#CAXLE").bind("change",CAXLEchange);
				$(".display").bind("change",displaychange);

				$("input").keyup(onKeyup).blur(onBlur);
				has3d = "WebKitCSSMatrix" in window || "MozPerspective" in document.body.style;
				/*@cc_on if (/^10/.test(@_jscript_version)) has3d = TRUE; @*/	//IE10 have 3d support

				resetOEF();
				
				if( !parseHash() ) addGear( undefined, true, 18, 3, 6, 20 );	// default gear;
				updateHash();
				readCookies();
				RPMchange();	// get initial value from input box
				maxSize();
			}
			function parseHash() {
				var h = location.hash;
				if( !h ) h="#200,200,100,6,1,0,0,4,1,8,2,4,27,-90,0,0,16,4,4,27,-60,1,1,12,1,12,20,-60,2,0,60,5,12,20,0,0,0,2,-563";
				if( h ) {
					var t = h.substr( 1 ),
						CRC=0,
						CRC2=0;
						
					if( t=="clear" ) return false;
						
					t = t.split(",");
					
					for( var i=0; i<t.length-1; i++ ) {
						CRC += Number(t[i]);
						CRC2 = Math.sin( Number(t[i]) )*100-CRC2;
					}
					if( t[i]!=Math.ceil(CRC%800+CRC2*2) ) return false;	// Wrong CRC

					var i=0, 
						gs,
						g = function() {
							return Number(t[i++]);
						}
						basex = g(),
						basey = g();
						
					setscale( g() );
					setRPM( g() );
					loop = animation = g()==1;
					var sg = g();
					rot = g();
					gs = g();
					
					for( var j=0; j<gs; j++ ) { addGearData( j==0?-1:g(), g()==1, g(), g(), g(), g(), g()); }
					for( var j=0; j<gs; j++ ) { addGearDataProcess( j ) };
					//for( var j=0; j<gs; j++ ) { updateGearDOM( j ) };
					positionGears( 0 );
					rotateGears( 0 );
					selectGear( sg );
					if( animation ) OEF();
					return true;
				}
				return false;
			}
			function updateHash() {
				var h  = "",
					S=",",
					CRC=0,
					CRC2=0,
					a=animation?1:0,
					g = function( n ) {
						h += n+S;
						CRC += Number(n);
						CRC2 = Math.sin( Number(n) )*100-CRC2;
					};
				g(gears[0].x);
				g(gears[0].x);
				g(getscale());
				g(getRPM());
				g(a);
				g(selectedgear);
				g(rot);
				g(gears.length);
				
				for( var i=0, gear; i<gears.length; i++ ) {
					gear = gears[i];
					if( i>0 ) { g(gear.parentID); }
					g(gear.axlejoint?1:0);
					g(gear.N);
					g(gear.D);
					g(gear.P);
					g(gear.PA);
					g(gear.jointangle);
				}
				g(0);	// for future use
				g(0);
				g(2);	// version
				h+=Math.ceil(CRC%800+CRC2*2);
				location.hash = "#"+h;
			}
			function onKeyup( e ) {
					//console.log("key: "+e.keyCode+" shift: "+e.shiftKey );
					shift = e.shiftKey;
					if(e.keyCode == 13) {
						$(this).trigger("enterKey");
					}
				
			}
			function onBlur( e ) {
				$(this).trigger("enterKey");
			}
			function resetOEF() {
				window.raf = (function(){
					return 	window.requestAnimationFrame       ||
							window.webkitRequestAnimationFrame ||
							window.mozRequestAnimationFrame    ||
							function( callback ) {
								window.setTimeout( callback, 100/6 );
							};
				})();
			}
			function OEF() {
				if( animation ) {
					if( realRPM<RPM ) { realRPM += 1 }
					else if( realRPM>RPM ) { realRPM -= 1 };
					if( Math.abs(realRPM-RPM)<1 ) realRPM=RPM;
				} else {
					realRPM -= 1;
					if( realRPM<0 ) { 
						realRPM=0;
						loop = false;
					}
				}
				if( loop ) raf( OEF );
				
				//console.log( RPM );
				
				rota = (realRPM/3600)*360;
				rot += rota;

 				rotateGears();
				if( loop==false ) { updateHash(); }
			}
			function anim( mode ) {
				switch( mode ) {
					
					case 0:
						animation = !animation
						if( animation ) {
							updateHash();
							if( !loop ) {
								loop = true;
								OEF();
							}
						}
						break;
					case 1:
						loop = false;
						animation = false;
						updateHash();
						break;
					case 2:
						loop = false;
						animation = false,
						realRPM = 0;
						rot = baserot;
						rotateGears();
						//OEF();
						updateHash();
						break;
					
				}
				
			}
			function setTheme( th ) {
				theme = th;
				$("body").attr("class", "col"+th );
				makeGrid();
				writeCookies();
			}
			function writeCookies() {
				$.cookie("theme", theme );
				$.cookie("guides", guides );
				$.cookie("geartext", geartext );
				$.cookie("grid", grid );
			}
			function readCookies() {
				var ctheme = $.cookie("theme"),
					cguides = $.cookie("guides"),
					cgeartext = $.cookie("geartext"),
					cgrid = $.cookie("grid");
				if( ctheme != undefined ) theme = ctheme;
				if( cguides != undefined ) guides = cguides=="true";
				if( cgeartext != undefined ) geartext = cgeartext=="true";
				if( cgrid != undefined ) grid = cgrid=="true";
				setguides( guides );
				setlabels( geartext );
				setgrid( grid );
				setGuidesClass();
				setLabelsClass();
				setTheme( theme );
			}
			function clearAll() {
				window.location = "http://geargenerator.com/#clear";
				window.location.reload();
			}
			
		</script>
		<link href='js/geargenerator.css' rel='stylesheet' type='text/css'>
	</head>
	<body class="col1">
		<div id="screencontainer">
			<div id="screen"></div>
		</div>
		<div id="panel">
			<h1 id="title">Gear Generator</h1>
			<p class="title">Gear</p><p class="title">Generator</p>
			<div id="animpanel">
				<label><h2>Animation:</h2></label>
				<button onclick="anim(0)">Start/Stop</button><button onclick="anim(1)">Freeze</button><button onclick="anim(2)">Reset</button><br>
				<label for="RPM">Speed (RPM)*:</label>
				<input type="text" id="RPM" value="6"><br>
				<span class="rem">* Shift + Enter: Set RPM of the selected gear</span>
			</div>
			<div id="gearlist">
				<label><h2>Gears:</h2></label>
				<button onclick="addNewGear()" title="Add a new gear connected to the selected one">Add New</button><button class="first" onclick="removeGear()" title="Remove selected gear and all child gears">Remove</button><button onclick="clearAll()" class="last" title="Clear all, and start with a single default gear">Clear</button>
				
				<ul id="gearselector">
					<!--<li class="selected">Gear 1 - Drive gear</li>
					<li>Gear 2 - second gear</li>-->
				</ul>
			</div>
			<h2>Connection properties</h2>
			<p>
				<label for="PG">Parent gear #:</label>
				<input type="text" id="PG"> <button class="select" onclick="selectParent()" title="Select parent gear">Select</button>
				<label for="CAXLE">Axle connection:</label>
				<input type="checkbox" checked="checked" id="CAXLE" class="thecheckbox"><br>
	
				<label for="CA">Connection angle:</label>
				<input type="text" id="CA"> <button class="first" onclick="Aadd(-5)">–</button><button class="last" onclick="Aadd(5)">+</button>
			</p>
			<h2>Gear properties</h2>
			<p>
				<label for="N">Number of teeth* (N):</label>
				<input type="text" id="N"> <button class="first" onclick="Nadd(-1)">–</button><button class="last" onclick="Nadd(1)">+</button><br>
	
				<label for="D">Pitch diameter* (D):</label>
				<input type="text" id="D"><br>
				
				<label for="P">Diametral pitch (P):</label>
				<input type="text" id="P"><br>
			
				<label for="PA">Pressure Angle (PA):</label>
				<input type="text" id="PA"> <button class="first" onclick="PAadd(-1)">–</button><button class="last" onclick="PAadd(1)">+</button><br>
				<span class="rem">* Shift + Enter: modifies the Diametral pitch</span>
			</p>
			<p>
				<form action="downloadsvg.php" method="post">
					<input name="data" type="hidden" id="svgdata">
					<input name="filename" type="hidden" id="svgfilename">
					<label>Gear vector image:</label> <button type="submit" name="downloadsvg" id="downloadsvg" title="Download selected Gear in SVG vector image format">Download SVG</button>
				</form>
				<!--<textarea id="out"></textarea>-->
			</p>
			<div>
				<h2>Display</h2>	
				<label for="scale">Scale (Pixel per Unit):</label>
				<input type="text" id="scale" value="100"> <button class="first" onclick="scalem(.5)">–</button><button class="last" onclick="scalem(2)">+</button><br>
				<label for="grid">Grid:</label>
				<input type="checkbox" id="grid" class="thecheckbox display"><br>
				<label for="guides">Gear guides:</label>
				<input type="checkbox" id="guides" class="thecheckbox display"><br>
				<label for="labels">Gear label:</label>
				<input type="checkbox" id="labels" class="thecheckbox display"><br>
				<label for="theme">Color theme:</label>
				<button class="first" onclick="setTheme(0)" title="Switch to Light theme">Light</button><button class="next" onclick="setTheme(1)" title="Switch to Blueprint theme">Blueprint</button><button class="last" onclick="setTheme(2)" title="Switch to Dark theme">Dark</button>
			</div>
			<div id="about">
				<h2>About</h2>
				<p>
					Gear Generator is a tool for creating <a href="http://en.wikipedia.org/wiki/Involute_gear" target="_blank">involute spur gears</a> and download them in SVG format. In addition it let you compose full gear layouts with connetcted gears to design multiple gears system with control of the input/output ratio and rotation speed. Gears can be animated with various speed to demonstrate working mechanism.
				</p>
				<p>
					Why this tool was created? Just for fun. I'm working on a hobby project, <a href="https://www.behance.net/wip/316985" target="_blank">a scale construction machine</a>, which needed some spur gears, and i quickly made a simple <a href="index_proto.html" target="_blank">spur gear creator</a> script in Javascript with SVG output. As it was done, i couldn't stop, and i added more and more features, and finally i got this tool. It was a pleasure to code the whole thing, i'm a bit sad it is already done, so if you have any idea, what would be a helpful feature, just let me know by sending an <a href="mailto:abel@iparigrafika.hu">e-mail</a> (I couldn't have done this tool without <a href="http://pageflip-books.com/" target="_blank">Pageflip</a>, my main project).
				</p>
				<p>
					Notes about browser compatibility: all new major browsers are supported (i didn't tested IE), but unfortunately Chrome can't render SVG circle correctly. The winners are: Opera for the best performance (shame on me, i never use it) and Firefox for the best looking SVG render.
				</p>
			</div>
			<div>
				<p>If you like it, please share:
					<a href="https://twitter.com/intent/tweet?original_referer=http%3a%2f%2fgeargenerator.com&amp;url=http%3a%2f%2fgeargenerator.com&amp;text=What+a+nice+gear+generator+%23HTML+%23CSS+via+%40AbelVincze" target="_blank"><svg style="margin-left: 12px;" version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="34px" height="25px" viewBox="0 0 34 25" xml:space="preserve"><path class="shareicon" d="M31.016,11.572c-0.971,0-1.908-0.136-2.793-0.384c0-0.03,0-0.06,0-0.091c0.154,0.02,0.315,0.03,0.479,0.03c1.3,0,2.445-0.629,3.129-1.587c-0.612,0.246-1.283,0.382-1.987,0.382c-0.63,0-1.233-0.109-1.788-0.308c-0.145-0.658-0.377-1.301-0.709-1.913c-2.406-4.452-6.177-3.977-6.177-3.977s2.776-0.54,2.646-1.276C23.686,1.71,21.12,2.852,21.12,2.852s1.424-0.77,1.224-1.096c-0.189-0.311-2.305,0.961-2.305,0.961s0.348-0.492,0.215-0.635c-0.134-0.143-1.818,1.271-3.108,3.364c-1.291,2.094-1.803,4.013-1.803,4.013s-0.664-0.812-2.166-1.824c-1.606-1.078-8.432-3.583-8.432-3.583S4.483,4.901,5.447,6.391c0.606,0.94,1.946,1.487,1.946,1.487s-0.552,0-0.98,0.06c-0.398,0.056-0.88,0.167-0.88,0.167S5.396,9.21,6.65,10.164c1.253,0.952,2.341,1.048,2.341,1.048s-0.682,0.049-1.197,0.225c-0.534,0.184-0.92,0.644-0.92,0.644s0.409,0.794,1.268,1.365c1.134,0.753,2.604,0.515,2.604,0.515s-1.316,0.338-1.23,1.372c0.123,1.518,2.347,1.211,2.347,1.211c-1.527,1.587-3.729,2.512-6.158,2.512c-2.196,0-4.213-0.74-5.703-2.072c0,0,8.422,11.141,22.605,3.168c2.902-1.633,4.925-4.441,5.47-7.353c0.256,0.049,0.521,0.076,0.792,0.076c1.206,0,2.283-0.52,3.009-1.336C31.591,11.557,31.305,11.572,31.016,11.572z"/></svg></a>
					<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fgeargenerator.com" target="_blank"><svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="30px" height="25px" viewBox="0 0 30 25" xml:space="preserve"><path class="shareicon" d="M20.035,24.729h-5.323V12.365h-2.659V8.103h2.659V5.545C14.712,2.069,16.216,0,20.48,0h3.551v4.263h-2.219c-1.662,0-1.771,0.596-1.771,1.708l-0.005,2.132h4.022l-0.473,4.262h-3.551V24.729z"/></svg></a>
					<a href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2fgeargenerator.com&amp;media=http%3a%2f%2fgeargenerator.com%2fshareimage.jpg&amp;description=Involute+spur+gear+generator+and+simulator+in+%23HTML+%23CSS" target="_blank"><svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="25px" viewBox="0 0 32 25" xml:space="preserve"><path class="shareicon" d="M19.607,16.155c-0.604,2.542-1.196,4.992-2.489,6.926c-0.394,0.592-0.792,1.337-1.466,1.656c-1-4.937,1.084-9.092,1.912-13.243c-1.055-2.06-0.397-5.552,1.852-5.945c3.262-0.575,2.402,3.206,1.85,4.965c-0.304,0.963-0.851,1.885-0.767,2.944c0.181,2.228,3.099,2.371,4.591,1.226c2.143-1.644,2.76-4.814,2.553-7.419C27.325,3.3,22.65,1.328,18.523,2.913c-2.125,0.819-4.059,2.697-4.338,5.456c-0.147,1.455,0.17,2.614,0.765,3.434c0.092,0.124,0.401,0.343,0.446,0.674c0.094,0.673-0.322,1.399-0.701,1.901c-2.113-0.586-3.205-2.412-3.379-4.719c-0.398-5.255,4.088-9.253,9.373-9.625c5.638-0.396,10.109,2.732,10.523,7.295c0.309,3.392-0.941,6.807-2.933,8.643c-1.493,1.379-4.673,2.73-7.271,1.41C20.434,17.087,20.18,16.729,19.607,16.155z"/></svg></a>
				</p>
			</div>
		</div>
		<div id="footer">
			<p><a href="http://iparigrafika.hu/" target="_blank">(C) 2014 - GG 1.01 - Created by Abel Vincze/Iparigrafika Ltd.</a></p>
		</div>
	</body>
	<script>
		reset();
		$("p.title").each(function() { replaceWithSVGText( $( this ), true, 6, 6  ); });
		replaceWithSVGText( $("#footer a"), true, 1, 1 );
	</script>
</html>
